!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";class t extends HTMLElement{constructor(){super(),this.isAnimating=!1,this.animationFrameId=null,this.elapsedTime=0,this.startTime=null,this.isGeneratingWave=!1,this.currentPath=null,this.targetPath=null,this.pendingTargetPath=null,this.intersectionObserver=null,this.observerOptions=null}connectedCallback(){const t=this.className,i=this.id??Math.random().toString(36).substring(7),s=this.getAttribute("style"),r=this.getAttribute("data-wave-face")||"top";this.points=parseInt(this.getAttribute("data-wave-points"))||6,this.variance=parseFloat(this.getAttribute("data-variance"))||3,this.duration=parseFloat(this.getAttribute("data-wave-speed"))||7500,this.vertical="left"===r||"right"===r;const n="right"===r,a="bottom"===r;this.width=this.vertical?160:1440,this.height=this.vertical?1440:160,this.startEndZero="true"===this.getAttribute("data-start-end-zero"),this.startZero="true"===this.getAttribute("data-start-zero"),this.endZero="true"===this.getAttribute("data-end-zero"),this.currentPath=e({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,startEndZero:this.startEndZero,startZero:this.startZero,endZero:this.endZero}),this.targetPath=e({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,startEndZero:this.startEndZero,startZero:this.startZero,endZero:this.endZero}),this.innerHTML=`\n      <?xml version="1.0" encoding="utf-8"?>\n      \x3c!--@huement/cosmicwave--\x3e\n      <svg\n        version="1.1"\n        viewBox="${this.vertical?"0 0 160 1440":"0 0 1440 160"}"\n        preserveAspectRatio="none"\n        class="${t||""}"\n        style="${n?"transform:scaleX(-1);":""}${a?"transform:scaleY(-1);":""}${s||""}"\n        id="${i}"\n        aria-hidden="true"\n        role="presentation"\n        xmlns="http://www.w3.org/2000/svg"\n        xmlns:xlink="http://www.w3.org/1999/xlink"\n      >\n        <path d="${this.currentPath}" style="stroke:inherit; fill: inherit"></path>\n      </svg>\n    `,this.svg=this.querySelector("svg"),this.path=this.querySelector("path"),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.generateNewWave=this.generateNewWave.bind(this);const h=this.getAttribute("data-wave-observe");h&&this.setupIntersectionObserver(h),"true"===this.getAttribute("data-wave-animate")&&(window.matchMedia("(prefers-reduced-motion: reduce)").matches||this.play())}play(t=null){if(this.isAnimating)return;this.isAnimating=!0;const i=t||this.duration,s=()=>{this.pendingTargetPath||(this.pendingTargetPath=e({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,startEndZero:this.startEndZero,startZero:this.startZero,endZero:this.endZero})),this.animateWave(i,(()=>{this.currentPath=this.targetPath,this.targetPath=this.pendingTargetPath,this.pendingTargetPath=e({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,startEndZero:this.startEndZero,startZero:this.startZero,endZero:this.endZero}),this.isAnimating&&s()}))};s()}pause(){this.isAnimating&&(this.isAnimating=!1,cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null,this.elapsedTime+=performance.now()-(this.startTime||performance.now()),this.startTime=null)}disconnectedCallback(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null)}setupIntersectionObserver(t){const[e,i="0px"]=t.split(":"),s="once"===e;this.observerOptions={root:null,rootMargin:i,threshold:0},this.intersectionObserver=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting||(this.generateNewWave(),s&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null))}))}),this.observerOptions),this.intersectionObserver.observe(this)}generateNewWave(t=800){this.isGeneratingWave||this.animationFrameId||(t<1&&(t=1),this.isGeneratingWave=!0,this.pendingTargetPath=e({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,startEndZero:this.startEndZero,startZero:this.startZero,endZero:this.endZero}),this.animateWave(t,(()=>{this.currentPath=this.targetPath,this.targetPath=this.pendingTargetPath,this.pendingTargetPath=null,this.isGeneratingWave=!1,this.animationFrameId=null})))}animateWave(t,s=null){const r=i(this.currentPath),n=i(this.targetPath);if(r.length!==n.length)return console.error("Point mismatch! Regenerating waves to ensure consistency."),this.currentPath=e({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,startEndZero:this.startEndZero,startZero:this.startZero,endZero:this.endZero}),void(this.targetPath=e({width:this.width,height:this.height,points:this.points,variance:this.variance,vertical:this.vertical,startEndZero:this.startEndZero,startZero:this.startZero,endZero:this.endZero}));const a=e=>{this.startTime||(this.startTime=e-this.elapsedTime);const i=e-this.startTime,h=Math.min(i/t,1),o=function(t,e,i,s=!1,r,n){const a=t.map(((t,r)=>{const n=e[r];return{cpX:t.cpX+(n.cpX-t.cpX)*i,cpY:s?t.cpY:t.cpY+(n.cpY-t.cpY)*i,x:s?t.x+(n.x-t.x)*i:t.x,y:s?t.y:t.y+(n.y-t.y)*i}}));let h=s?`M ${n} ${r} L ${a[0].x} ${r}`:`M 0 ${r} L 0 ${a[0].y}`;for(let t=0;t<a.length;t++){const{cpX:e,cpY:i,x:s,y:r}=a[t];h+=` Q ${e} ${i}, ${s} ${r}`}return h+=s?` L 0 0 L ${n} 0 L ${n} ${r} Z`:` L ${n} ${r} Z`,h}(r,n,h,this.vertical,this.height,this.width);this.path.setAttribute("d",o),h<1?this.animationFrameId=requestAnimationFrame(a):(this.elapsedTime=0,this.startTime=null,s&&s())};this.animationFrameId=requestAnimationFrame(a)}}function e({width:t,height:e,points:i,variance:s,vertical:r=!1,startEndZero:n=!1,startZero:a=!1,endZero:h=!1}){const o=[],c=r?e/(i-1):t/(i-1);for(let n=0;n<i;n++){const i=r?e-c*n:c*n,a=r?t-.1*t-Math.random()*(s*t*.25):e-.1*e-Math.random()*(s*e*.25);o.push(r?{x:a,y:i}:{x:i,y:a})}n?r?(o[0].x=0,o[o.length-1].x=0):(o[0].y=e,o[o.length-1].y=e):a?r?(o[0].x=0,o[o.length-1].x=e):(o[0].y=e,o[o.length-1].y=0):h&&(r?(o[0].x=e,o[o.length-1].x=0):(o[0].y=0,o[o.length-1].y=e));let d=r?`M ${t} ${e} L ${o[0].x} ${e}`:`M 0 ${e} L 0 ${o[0].y}`;for(let t=0;t<o.length-1;t++){const e=o[t],i=o[t+1],s=(e.x+i.x)/2,r=(e.y+i.y)/2;d+=` Q ${e.x} ${e.y}, ${s} ${r}`}const l=o[o.length-1];return d+=r?` Q ${l.x} ${l.y}, 0 0 L ${t} 0 L ${t} ${e} Z`:` Q ${l.x} ${l.y}, ${t} ${l.y} L ${t} ${e} Z`,d}function i(t){const e=[],i=/Q\s([\d.]+)\s([\d.]+),\s([\d.]+)\s([\d.]+)/g;let s;for(;null!==(s=i.exec(t));)e.push({cpX:parseFloat(s[1]),cpY:parseFloat(s[2]),x:parseFloat(s[3]),y:parseFloat(s[4])});return e}customElements.define("cosmic-wave",t)}));
